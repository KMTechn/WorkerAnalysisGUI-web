# 작업자 분석 시스템 종합 개요

## 시스템 구성도

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  Container_Audit │    │ Inspection_worker│    │   Label_Match   │    │ 기타 제조 시스템 │
│   (이적 검사)    │    │   (품질 검사)    │    │  (바코드 검증)   │    │                │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │                      │
          │ CSV 로그 생성         │ CSV 로그 생성         │ JSON 로그 생성        │ CSV 로그 생성
          │                      │                      │                      │
          └──────────────────────┼──────────────────────┘                      │
                                 │                                             │
                        ┌────────▼────────┐                                    │
                        │    C:\Sync      │◄───────────────────────────────────┘
                        │  (데이터 저장소)  │
                        └────────┬────────┘
                                 │
                                 │ 실시간 파일 감시
                                 │
                        ┌────────▼────────┐
                        │WorkerAnalysisGUI│
                        │      -web       │
                        │  (분석 엔진)     │
                        └────────┬────────┘
                                 │
                    ┌────────────┼────────────┐
                    │            │            │
           ┌────────▼──┐  ┌──────▼──┐  ┌─────▼─────┐
           │실시간 대시보드│  │분석 리포트│  │ 성능 모니터│
           └───────────┘  └─────────┘  └───────────┘

                 [Label_Match는 현재 독립적 운영]
```

---

## 1. 핵심 구성 요소

### 1.1 데이터 수집 시스템

#### Container_Audit (이적 검사 시스템)
- **목적**: 제품 이적 검사 및 품질 확인
- **특징**:
  - 100% 양품 처리 방식
  - 트레이 단위 작업 관리
  - 신형 현품표 시스템 지원
- **데이터 형식**: `이적검사이벤트로그_[작업자]_[날짜].csv`

#### Inspection_worker (품질 검사 시스템)
- **목적**: 제품 품질 검사 및 불량품 관리
- **특징**:
  - 양품/불량품 판정 (F12 페달)
  - 리워크 및 불량품 통합 처리
  - 라벨 생성 및 관리
- **데이터 형식**: `검사작업이벤트로그_[작업자]_[날짜].csv`

#### Label_Match (바코드 검증 시스템)
- **목적**: 5단계 순차 바코드 스캔 검증
- **특징**:
  - 설정 가능한 검증 규칙 (`validation_rules.csv`)
  - 실시간 오디오 피드백 (단계별 음성 안내)
  - 자동 업데이트 기능 (GitHub 연동)
  - 독립적인 GUI 애플리케이션 (Tkinter 기반)
- **데이터 형식**: 일별 JSON 로그 파일
- **현재 상태**: WorkerAnalysisGUI-web와 미연동

### 1.2 데이터 저장소 (C:\Sync)
- **구조**:
  ```
  C:\Sync\
  ├── 이적검사이벤트로그_*.csv
  ├── 검사작업이벤트로그_*.csv
  ├── 포장실작업이벤트로그_*.csv
  ├── labels/              # 라벨 이미지 파일
  ├── defects_merged/      # 불량품 통합 데이터
  └── backup/              # 백업 파일
  ```

### 1.3 분석 엔진 (WorkerAnalysisGUI-web)
- **기술 스택**: Python Flask + SocketIO
- **핵심 기능**:
  - 실시간 데이터 처리
  - 성능 메트릭 계산
  - 웹 기반 시각화
  - 캐싱 및 최적화

---

## 2. 데이터 분석 메트릭

### 2.1 생산성 지표
| 메트릭 | 설명 | 계산 방식 |
|--------|------|-----------|
| 평균 작업 시간 | 트레이당 평균 완료 시간 | `total_work_time / session_count` |
| 시간당 처리량 | 시간당 완료된 트레이 수 | `completed_trays / total_hours` |
| 준비 시간 | 첫 스캔까지의 대기 시간 | `first_scan_time - session_start` |
| 유휴 시간 | 작업 중 비활성 시간 | `total_idle_duration` |

### 2.2 품질 지표
| 메트릭 | 설명 | 계산 방식 |
|--------|------|-----------|
| 초도수율 | 오류 없이 완료된 세션 비율 | `error_free_sessions / total_sessions` |
| 불량률 | 전체 대비 불량품 비율 | `defective_count / total_count` |
| 재작업률 | 리워크 세션 비율 | `rework_sessions / total_sessions` |

### 2.3 시스템 사용 패턴
- 모드별 사용 빈도
- 오류 발생 패턴
- 트레이 보류/복구 빈도
- 세션 복구 성공률

---

## 3. 실시간 모니터링 기능

### 3.1 파일 감시 시스템 (Watchdog)
```python
class LogFileHandler(FileSystemEventHandler):
    def on_modified(self, event):
        # 5초 간격 중복 방지
        if time.time() - self.last_triggered_time < 5:
            return
        # 실시간 클라이언트 업데이트 전송
        self.socketio.emit('data_updated')
```

### 3.2 캐싱 전략
- **세션 캐시**: 날짜 범위별 세션 데이터
- **파일 캐시**: 최근 접근 파일 메타데이터
- **메트릭 캐시**: 계산된 성능 지표

### 3.3 성능 최적화
- 청크 단위 CSV 읽기
- 병렬 파일 처리
- 메모리 효율적 데이터 구조

---

## 4. 웹 인터페이스 기능

### 4.1 대시보드 구성
1. **실시간 현황**: 당일 작업 현황 및 실시간 업데이트
2. **작업자 성과**: 개별 작업자별 성과 분석
3. **생산 현황**: 품목별/일별 생산 현황
4. **품질 분석**: 불량률 및 품질 트렌드
5. **레이더 차트**: 다차원 성과 비교

### 4.2 레이더 차트 메트릭 구성
```javascript
{
  "검사실": {
    "신속성": "avg_work_time",
    "준비성": "avg_latency",
    "무결점달성률": "first_pass_yield",
    "안정성": "work_time_std",
    "품질 정확도": "defect_rate"
  }
}
```

---

## 5. 데이터 품질 관리

### 5.1 무결성 검증
- **세션 완결성**: START/COMPLETE 이벤트 쌍 확인
- **시간 순서**: 타임스탬프 일관성 검증
- **바코드 중복**: 동일 세션 내 중복 스캔 감지
- **데이터 타입**: 컬럼별 데이터 형식 검증

### 5.2 예외 처리
- 파일 접근 오류 (잠금, 권한)
- JSON 파싱 실패
- 네트워크 연결 오류
- 메모리 부족 상황

---

## 6. 보안 및 백업

### 6.1 데이터 보호
- 작업자명 익명화 옵션
- 민감 정보 마스킹
- 접근 권한 제한

### 6.2 백업 전략
- 일별 자동 백업
- 분기별 아카이브
- 중요 설정 파일 버전 관리

---

## 7. 확장성 및 향후 계획

### 7.1 시스템 확장성
- 모듈식 아키텍처
- API 기반 연동
- 플러그인 시스템

### 7.2 향후 개발 계획
1. **Label_Match 통합**: JSON 데이터 파서 및 바코드 검증 분석 모듈 추가
2. **통합 대시보드**: 모든 시스템의 데이터를 종합한 통합 분석 뷰
3. **AI 기반 예측**: 성과 예측 및 이상 감지
4. **모바일 대응**: 반응형 웹 인터페이스
5. **다국어 지원**: 인터페이스 국제화
6. **고급 분석**: 머신러닝 기반 패턴 분석

---

## 8. 기술 사양

### 8.1 시스템 요구사항
- **OS**: Windows 10/11
- **Python**: 3.8+
- **메모리**: 최소 4GB, 권장 8GB
- **디스크**: 데이터 저장용 충분한 공간

### 8.2 주요 라이브러리
- **Flask**: 웹 프레임워크
- **SocketIO**: 실시간 통신
- **Pandas**: 데이터 처리
- **Watchdog**: 파일 감시
- **NumPy**: 수치 계산

---

## 9. 운영 가이드

### 9.1 일상 운영
1. **시스템 시작**: `python app.py`
2. **웹 접속**: `http://localhost:5000`
3. **로그 모니터링**: 콘솔 출력 확인
4. **데이터 백업**: 정기적 백업 실행

### 9.2 문제 해결
- **데이터 불일치**: 캐시 초기화 및 재로딩
- **성능 저하**: 메모리 사용량 및 디스크 공간 확인
- **연결 오류**: 네트워크 및 방화벽 설정 확인

---

**시스템 버전**: v2.0
**문서 최종 수정**: 2025-09-30
**관리자**: 시스템 개발팀